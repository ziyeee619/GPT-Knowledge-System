(this["webpackJsonpgpt-knowledge-system"]=this["webpackJsonpgpt-knowledge-system"]||[]).push([[0],{153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){},281:function(e,t,n){},282:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},298:function(e,t,n){},510:function(e,t,n){},511:function(e,t,n){},512:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(67),a=n.n(c),r=(n(281),n(282),n(153),n(154),n(155),n(21)),o=n(1);var i=function(e){let{isOpen:t,onLinkClick:n}=e;return Object(o.jsx)("nav",{className:"sidebar "+(t?"active":""),children:Object(o.jsxs)("ul",{children:[Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/",onClick:n,children:"\u9996\u9801"})}),Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/knowledge",onClick:n,children:"\u77e5\u8b58\u5eab"})}),Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/documents",onClick:n,children:"\u6587\u6a94\u7ba1\u7406"})}),Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/collaboration",onClick:n,children:"\u5354\u4f5c\u4e2d\u5fc3"})}),Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/analytics",onClick:n,children:"\u6578\u64da\u5206\u6790"})}),Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/feedback",onClick:n,children:"\u53cd\u994b"})})]})})},l=n(517);const d=l.a.create({baseURL:"http://localhost:5000",headers:{"Content-Type":"application/json"}});d.interceptors.request.use((e=>(console.log("API Request:",e.method.toUpperCase(),e.url),e)),(e=>(console.error("API Request Error:",e),Promise.reject(e)))),d.interceptors.response.use((e=>(console.log("API Response:",e.config.url,e.data),e)),(e=>{var t;return console.error("API Response Error:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message),Promise.reject(e)}));var j=d;var b=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)([]),[a,r]=Object(s.useState)(""),[i,l]=Object(s.useState)("likes"),[j,b]=Object(s.useState)(null),[h,u]=Object(s.useState)(!1),[p,O]=Object(s.useState)("\u5168\u90e8");Object(s.useEffect)((()=>{(async()=>{try{const e=await d.get("/api/questions");console.log("Fetched questions:",e.data.data);const n=(e.data.data||[]).map((e=>({...e,likes:e.likes||0})));t(n),x(n,a,i)}catch(e){console.error("Error fetching questions:",e)}})()}),[a,i]);const x=(e,t,n)=>{let s=e.filter((e=>e.question.toLowerCase().includes(t.toLowerCase())));"likes"===n?s.sort(((e,t)=>t.likes-e.likes)):"newest"===n&&s.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),c(s)};return Object(o.jsxs)("div",{className:"knowledge-base",style:{minHeight:"calc(100vh - 140px)"},children:[Object(o.jsx)("h1",{children:"\u77e5\u8b58\u5eab"}),Object(o.jsxs)("div",{className:"knowledge-controls",children:[Object(o.jsx)("input",{type:"text",placeholder:"\u641c\u5c0b\u554f\u984c...",value:a,onChange:e=>r(e.target.value),className:"search-box"}),Object(o.jsx)("select",{value:p,onChange:e=>O(e.target.value),className:"sort-dropdown",children:["\u5168\u90e8","IT","\u4eba\u8cc7","\u8ca1\u52d9","\u884c\u653f","\u7e3d\u52d9","\u6cd5\u52d9","\u63a1\u8cfc","\u7814\u767c","\u884c\u92b7","\u5ba2\u670d","\u77e5\u8b58\u7ba1\u7406"].map((e=>Object(o.jsx)("option",{value:e,children:e},e)))}),Object(o.jsx)("button",{onClick:async()=>{try{const e=new URLSearchParams;a&&e.append("keyword",a),p&&"\u5168\u90e8"!==p&&e.append("category",p);const n=await d.get(`/search?${e.toString()}`);t(n.data.data||[]),x(n.data.data||[],a,i)}catch(e){console.error("\u641c\u5c0b\u5931\u6557:",e),alert("\u641c\u5c0b\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66")}},style:{marginLeft:"8px"},children:"\u641c\u5c0b"}),Object(o.jsxs)("select",{className:"sort-dropdown",value:i,onChange:e=>l(e.target.value),children:[Object(o.jsx)("option",{value:"likes",children:"\u71b1\u9580"}),Object(o.jsx)("option",{value:"newest",children:"\u6700\u65b0"})]})]}),Object(o.jsxs)("table",{className:"knowledge-table",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"\u554f\u984c"}),Object(o.jsx)("th",{children:"\u5206\u985e"}),Object(o.jsx)("th",{children:"\u8b9a"}),Object(o.jsx)("th",{children:"\u65e5\u671f"})]})}),Object(o.jsx)("tbody",{children:n.map(((e,t)=>Object(o.jsxs)("tr",{onClick:()=>(b(e),void u(!0)),children:[Object(o.jsx)("td",{children:e.question}),Object(o.jsx)("td",{children:e.category||"\u672a\u5206\u985e"}),Object(o.jsx)("td",{children:Object(o.jsxs)("span",{style:{backgroundColor:"#e3f2fd",border:"1px solid #e0e0e0",padding:"8px 16px",borderRadius:"4px",cursor:"default",display:"flex",alignItems:"center",gap:"5px"},children:["\ud83d\udc4d ",e.likes]})}),Object(o.jsx)("td",{children:new Date(e.created_at).toLocaleDateString()})]},e._id)))})]}),h&&j&&Object(o.jsx)("div",{className:"modal-overlay",onClick:()=>u(!1),children:Object(o.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Object(o.jsx)("h2",{children:j.question}),Object(o.jsx)("p",{children:j.answer}),Object(o.jsxs)("div",{className:"modal-actions",children:[Object(o.jsxs)("button",{onClick:()=>(async n=>{try{if(!(await d.post(`/api/questions/${n}/like`)).data.success)throw new Error("\u9ede\u8b9a\u5931\u6557");const s=e.map((e=>e._id===n?{...e,likes:e.likes+1}:e));t(s),x(s,a,i)}catch(r){var s,c;console.error("Error liking question:",r),alert("\u9ede\u8b9a\u5931\u6557\uff1a"+((null===(s=r.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.error)||"\u8acb\u7a0d\u5f8c\u518d\u8a66"))}})(j._id),style:{backgroundColor:"#e3f2fd",color:"#000",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"default",marginRight:"10px",pointerEvents:"none"},children:["\ud83d\udc4d \u9ede\u8b9a (",j.likes,")"]}),Object(o.jsx)("button",{onClick:()=>{u(!1),b(null)},style:{backgroundColor:"#6c757d",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},children:"\u95dc\u9589"})]})]})})]})};var h=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)(!1),a=async()=>{try{const e=await fetch("/api/files"),n=await e.json();n.success?t(n.files):t([])}catch{t([])}};return Object(s.useEffect)((()=>{a()}),[]),Object(o.jsxs)("div",{className:"document-management",children:[Object(o.jsx)("h1",{children:"\u6587\u6a94\u7ba1\u7406"}),Object(o.jsx)("div",{className:"upload-section",children:Object(o.jsx)("input",{type:"file",onChange:async e=>{const t=e.target.files[0];if(!t)return;c(!0);const n=new FormData;n.append("file",t);try{const e=localStorage.getItem("token"),t=await fetch("/api/upload",{method:"POST",headers:e?{Authorization:"Bearer "+e}:{},body:n}),s=await t.json();s.success?(a(),alert("\u4e0a\u50b3\u6210\u529f")):alert(s.error||"\u4e0a\u50b3\u5931\u6557")}catch{alert("\u4e0a\u50b3\u5931\u6557")}c(!1)},className:"file-input",disabled:n})}),Object(o.jsxs)("div",{className:"file-list",children:[Object(o.jsx)("h2",{children:"\u5df2\u4e0a\u50b3\u6587\u4ef6"}),Object(o.jsx)("ul",{children:e.map(((e,t)=>Object(o.jsxs)("li",{className:"file-item",children:[Object(o.jsx)("span",{className:"file-name",children:e.filename}),Object(o.jsxs)("span",{style:{marginLeft:12,color:"#888",fontSize:14},children:["\u4e0a\u50b3\u8005\uff1a",e.uploader||"\u672a\u77e5"]}),Object(o.jsx)("span",{style:{marginLeft:12,color:"#888",fontSize:14},children:e.upload_time?new Date(e.upload_time).toLocaleString():""}),Object(o.jsx)("a",{className:"download-btn",href:`/api/download/${encodeURIComponent(e.filename)}`,download:e.filename,style:{marginLeft:12},children:"\u4e0b\u8f09"})]},t)))})]})]})},u=(n(295),n(113));n(296);const p={todo:[],inProgress:[],done:[]};var O=()=>{const[e,t]=Object(s.useState)(p),[n,c]=Object(s.useState)(""),[a,r]=Object(s.useState)("todo");return Object(o.jsxs)("div",{className:"task-board-container",children:[Object(o.jsx)("h2",{children:"\ud83d\udcdd \u4efb\u52d9\u770b\u677f"}),Object(o.jsxs)("form",{onSubmit:s=>{if(s.preventDefault(),!n.trim())return;const r={id:Date.now().toString(),content:n.trim()};t({...e,[a]:[...e[a],r]}),c("")},style:{marginBottom:16,display:"flex",gap:8},children:[Object(o.jsx)("input",{type:"text",placeholder:"\u8f38\u5165\u65b0\u4efb\u52d9\u5167\u5bb9...",value:n,onChange:e=>c(e.target.value),style:{flex:1,fontSize:16,padding:8}}),Object(o.jsxs)("select",{value:a,onChange:e=>r(e.target.value),style:{fontSize:16,padding:8},children:[Object(o.jsx)("option",{value:"todo",children:"\u5f85\u8655\u7406"}),Object(o.jsx)("option",{value:"inProgress",children:"\u9032\u884c\u4e2d"}),Object(o.jsx)("option",{value:"done",children:"\u5df2\u5b8c\u6210"})]}),Object(o.jsx)("button",{type:"submit",style:{fontSize:16,padding:"8px 16px"},children:"\u65b0\u589e\u4efb\u52d9"})]}),Object(o.jsx)(u.a,{onDragEnd:n=>{const{source:s,destination:c}=n;if(!c)return;const a=Array.from(e[s.droppableId]),r=Array.from(e[c.droppableId]),[o]=a.splice(s.index,1);s.droppableId===c.droppableId?(a.splice(c.index,0,o),t({...e,[s.droppableId]:a})):(r.splice(c.index,0,o),t({...e,[s.droppableId]:a,[c.droppableId]:r}))},children:Object(o.jsx)("div",{className:"task-columns",children:Object.entries(e).map((n=>{let[s,c]=n;return Object(o.jsx)(u.c,{droppableId:s,children:n=>Object(o.jsxs)("div",{className:"task-column",ref:n.innerRef,...n.droppableProps,children:[Object(o.jsx)("h3",{children:"todo"===s?"\ud83d\udccc \u5f85\u8655\u7406":"inProgress"===s?"\ud83d\udea7 \u9032\u884c\u4e2d":"\u2705 \u5df2\u5b8c\u6210"}),c.map(((n,c)=>Object(o.jsx)(u.b,{draggableId:n.id,index:c,children:c=>Object(o.jsxs)("div",{className:"task-card",ref:c.innerRef,...c.draggableProps,...c.dragHandleProps,style:{display:"flex",alignItems:"center",gap:8,...c.draggableProps.style},children:[Object(o.jsx)("span",{style:{flex:1},children:n.content}),Object(o.jsx)("button",{onClick:()=>((n,s)=>{t({...e,[n]:e[n].filter((e=>e.id!==s))})})(s,n.id),style:{background:"#ff4d4f",color:"#fff",border:"none",borderRadius:4,padding:"2px 8px",cursor:"pointer"},title:"\u522a\u9664\u4efb\u52d9",children:"\u522a\u9664"})]})},n.id))),n.placeholder]})},s)}))})})]})};var x=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)("");return Object(o.jsx)("div",{className:"collaboration-container",children:Object(o.jsxs)("div",{className:"content-wrapper",children:[Object(o.jsx)("h1",{className:"collaboration-title",children:"\ud83d\udfe3 \u5354\u4f5c\u4e2d\u5fc3"}),Object(o.jsx)(O,{}),Object(o.jsx)("h2",{className:"section-title",children:"\ud83d\udcdd \u7559\u8a00\u8a0e\u8ad6\u5340"}),Object(o.jsxs)("div",{className:"comment-section",children:[Object(o.jsx)("div",{className:"comment-list",children:e.map((e=>Object(o.jsxs)("div",{className:"comment",children:[Object(o.jsxs)("strong",{children:[e.user,"\uff1a"]})," ",e.text]},e.id)))}),Object(o.jsxs)("div",{className:"comment-input",children:[Object(o.jsx)("textarea",{value:n,onChange:e=>c(e.target.value),placeholder:"\u7559\u4e0b\u4f60\u7684\u8a0e\u8ad6\u7559\u8a00..."}),Object(o.jsx)("button",{onClick:()=>{if(""!==n.trim()){const s={id:e.length+1,user:"\u4f60",text:n};t([...e,s]),c("")}},children:"\u9001\u51fa"})]})]})]})})},m=n(514),g=n(515),f=n(110),y=n(111),v=n(54),w=n(73),k=n(270),S=n(516),C=n(112),N=n(518),A=n(271),T=n(109);n(298);var E=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)([]),[a,r]=Object(s.useState)([]),[i,l]=Object(s.useState)([]),[d,j]=Object(s.useState)("monthly");Object(s.useEffect)((()=>{fetch("/api/questions").then((e=>e.json())).then((e=>{const n=e.data||[];if("weekly"===d){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=Array(7).fill(0);n.forEach((e=>{const t=new Date(e.created_at);s[t.getDay()]++})),t(e.map(((e,t)=>({date:e,count:s[t]}))))}else{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=Array(12).fill(0);n.forEach((e=>{const t=new Date(e.created_at);s[t.getMonth()]++})),t(e.map(((e,t)=>({date:e,count:s[t]}))))}const s={};n.forEach((e=>{const t=e.category||"\u672a\u5206\u985e";s[t]=(s[t]||0)+(e.likes||0)})),c(Object.entries(s).map((e=>{let[t,n]=e;return{category:t,likes:n}})));const a={};n.forEach((e=>{const t=e.category||"\u672a\u5206\u985e";a[t]=(a[t]||0)+1})),r(Object.entries(a).map((e=>{let[t,n]=e;return{name:t,value:n}})));const o={};n.forEach((e=>{const t=e.username||e.user||e.uploader||"";t&&(o[t]=(o[t]||0)+1)})),l(Object.entries(o).map((e=>{let[t,n]=e;return{username:t,count:n}})).sort(((e,t)=>t.count-e.count)).slice(0,10))}))}),[d]);const b=["#8884d8","#82ca9d","#ffc658","#ff8042"];return Object(o.jsxs)("div",{className:"data-analysis",children:[Object(o.jsx)("h1",{children:"\ud83d\udcca \u6578\u64da\u5206\u6790"}),Object(o.jsxs)("div",{className:"time-filter",children:[Object(o.jsx)("label",{children:"\u6642\u9593\u7bc4\u570d\uff1a"}),Object(o.jsxs)("select",{value:d,onChange:e=>j(e.target.value),children:[Object(o.jsx)("option",{value:"weekly",children:"\u8fd1\u4e00\u9031"}),Object(o.jsx)("option",{value:"monthly",children:"\u8fd1\u4e00\u6708"})]})]}),Object(o.jsx)("section",{children:Object(o.jsxs)("div",{className:"analysis-section",children:[Object(o.jsx)("h2",{children:"\ud83d\udfe2 \u554f\u7b54\u91cf\u8da8\u52e2"}),Object(o.jsxs)(m.a,{width:600,height:300,data:e,children:[Object(o.jsx)(g.a,{strokeDasharray:"3 3"}),Object(o.jsx)(f.a,{dataKey:"date"}),Object(o.jsx)(y.a,{allowDecimals:!1}),Object(o.jsx)(v.a,{}),Object(o.jsx)(w.a,{}),Object(o.jsx)(k.a,{type:"monotone",dataKey:"count",stroke:"#007bff",activeDot:{r:8}})]})]})}),Object(o.jsx)("section",{children:Object(o.jsxs)("div",{className:"analysis-section",children:[Object(o.jsx)("h2",{children:"\ud83d\udfe1 \u5404\u5206\u985e\u9ede\u8b9a\u6578"}),Object(o.jsxs)(S.a,{width:600,height:300,data:n,children:[Object(o.jsx)(g.a,{strokeDasharray:"3 3"}),Object(o.jsx)(f.a,{dataKey:"category"}),Object(o.jsx)(y.a,{}),Object(o.jsx)(v.a,{}),Object(o.jsx)(C.a,{dataKey:"likes",fill:"#ff8042"})]})]})}),Object(o.jsx)("section",{children:Object(o.jsxs)("div",{className:"analysis-section",children:[Object(o.jsx)("h2",{children:"\ud83d\udd35 \u6700\u53d7\u6b61\u8fce\u5206\u985e"}),Object(o.jsxs)(N.a,{width:400,height:300,children:[Object(o.jsx)(A.a,{data:a,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"value",label:!0,children:a.map(((e,t)=>Object(o.jsx)(T.a,{fill:b[t%b.length]},`cell-${t}`)))}),Object(o.jsx)(v.a,{})]})]})}),Object(o.jsx)("section",{children:Object(o.jsxs)("div",{className:"analysis-section",children:[Object(o.jsx)("h2",{children:"\ud83d\udc64 \u4f7f\u7528\u8005\u6d3b\u8e8d\u6392\u884c\u699c"}),Object(o.jsxs)("table",{className:"active-users-table",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"#"}),Object(o.jsx)("th",{children:"\u4f7f\u7528\u8005"}),Object(o.jsx)("th",{children:"\u554f\u7b54\u6578"})]})}),Object(o.jsx)("tbody",{children:i.map(((e,t)=>Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:t+1}),Object(o.jsx)("td",{children:e.username}),Object(o.jsx)("td",{children:e.count})]},e.username)))})]})]})})]})};var I=function(){const[e,t]=Object(s.useState)(""),[n,c]=Object(s.useState)(""),[a,r]=Object(s.useState)(0),[i,l]=Object(s.useState)(!1),[d,b]=Object(s.useState)(!1),[h,u]=Object(s.useState)(null),[p,O]=Object(s.useState)(null),[x,m]=Object(s.useState)(!1),[g,f]=Object(s.useState)("");return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)("h1",{children:"AI \u77e5\u8b58\u5eab\u554f\u7b54\u7cfb\u7d71"}),Object(o.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),e.trim()){l(!0),u(""),c(""),m(!1),r(0),b(!1);try{let n=localStorage.getItem("username")||"anonymous";const s=await j.post("/ask",{question:e,username:n});if(c(s.data.answer||""),f(s.data.category||""),O(s.data.questionId),void 0!==s.data.likes&&r(s.data.likes),s.data.isCollected?m(!0):m(!1),!s.data.questionId)throw new Error("\u672a\u6536\u5230\u554f\u984c ID");localStorage.setItem("currentQuestionId",s.data.questionId),u(null),t("")}catch(h){console.error("Error:",h),"\u672a\u6536\u5230\u554f\u984c ID"!==h.message&&(u(h.message||"\u767c\u751f\u932f\u8aa4\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"),alert(h.message||"\u767c\u751f\u932f\u8aa4\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"))}finally{l(!1)}}else alert("\u8acb\u8f38\u5165\u554f\u984c")},className:"question-box",children:[Object(o.jsx)("textarea",{placeholder:"\u8acb\u8f38\u5165\u60a8\u7684\u554f\u984c...",value:e,onChange:e=>t(e.target.value),disabled:i}),Object(o.jsx)("button",{type:"submit",disabled:i,children:i?"\u6b63\u5728\u601d\u8003...":"\u2728 \u63d0\u554f"})]}),n&&Object(o.jsxs)("div",{className:"answer-box",children:[Object(o.jsx)("h2",{children:"\u2728 AI \u56de\u7b54\uff1a"}),Object(o.jsx)("p",{children:n}),Object(o.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"15px"},children:[Object(o.jsx)("button",{onClick:()=>{if(!x)return r(a+1),b(!0),void alert("\u6b64\u554f\u984c\u5c1a\u672a\u6536\u85cf\uff0c\u9ede\u8b9a\u50c5\u66ab\u5b58\u65bc\u672c\u5730");(async()=>{try{const e=p||localStorage.getItem("currentQuestionId");if(!e)return r(a+1),b(!0),void alert("\u6b64\u554f\u984c\u5c1a\u672a\u6536\u85cf\uff0c\u9ede\u8b9a\u50c5\u66ab\u5b58\u65bc\u672c\u5730");const t=await j.post(`/api/questions/${e}/like`);if(!t.data.success)throw new Error(t.data.error||"\u9ede\u8b9a\u5931\u6557");r(a+1),b(!0),u(null)}catch(h){console.error("Error liking:",h),u(h.message||"\u9ede\u8b9a\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"),alert(h.message||"\u9ede\u8b9a\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66")}})()},disabled:d,title:x?"":"\u6b64\u554f\u984c\u5c1a\u672a\u6536\u85cf\uff0c\u9ede\u8b9a\u50c5\u66ab\u5b58\u65bc\u672c\u5730",children:d?"\u5df2\u9ede\u8b9a":`\ud83d\udc4d \u9ede\u8b9a (${a})`}),Object(o.jsx)("button",{onClick:async()=>{try{if(!n)throw new Error("\u6c92\u6709\u53ef\u6536\u85cf\u7684\u7b54\u6848");if(x)return void alert("\u6b64\u554f\u984c\u5df2\u6536\u85cf\u5230\u6578\u64da\u5eab");const s=await j.post("/collect",{question:e,answer:n,category:g,likes:a});var t;if(!s.data||s.data.error)throw new Error((null===(t=s.data)||void 0===t?void 0:t.error)||"\u6536\u85cf\u5931\u6557");m(!0),"/knowledge"===window.location.pathname?window.location.reload():window.location.href="/knowledge"}catch(h){console.error("Error saving:",h),u(h.message||"\u6536\u85cf\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"),alert(h.message||"\u6536\u85cf\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66")}},disabled:x||!n,children:x?"\u5df2\u6536\u85cf":"\u2728 \u6536\u85cf\u5230\u6578\u64da\u5eab"})]})]}),h&&Object(o.jsx)("div",{style:{color:"red",marginTop:"20px"},children:"\u672a\u6536\u5230\u554f\u984c ID"===h?null:h})]})};var _=()=>{const[e,t]=Object(s.useState)(""),[n,c]=Object(s.useState)(""),a=localStorage.getItem("username")||"anonymous";return Object(o.jsxs)("div",{style:{maxWidth:600,margin:"0 auto",padding:24},children:[Object(o.jsx)("h2",{style:{textAlign:"center"},children:"\u53cd\u994b"}),Object(o.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),e.trim())try{await l.a.post("/api/feedback",{username:a,feedback:e.trim()}),c("\u611f\u8b1d\u60a8\u7684\u53cd\u994b\uff01"),t("")}catch(s){c("\u9001\u51fa\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")}else c("\u8acb\u8f38\u5165\u60a8\u7684\u53cd\u994b\u5167\u5bb9\u3002")},children:[Object(o.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"\u8acb\u8f38\u5165\u60a8\u7684\u53cd\u994b...",rows:6,style:{width:"100%",marginBottom:16,resize:"vertical"}}),Object(o.jsx)("div",{style:{textAlign:"center"},children:Object(o.jsx)("button",{type:"submit",style:{background:"#4caf50",color:"#fff",padding:"8px 24px",border:"none",borderRadius:4},children:"\u9001\u51fa\u53cd\u994b"})})]}),n&&Object(o.jsx)("div",{style:{textAlign:"center",color:n.includes("\u611f\u8b1d")?"green":"red",marginTop:12},children:n})]})},D=n(19);function R(){const e=Object(D.g)(),t=Object(D.f)(),n="/admin/login"===e.pathname;return Object(o.jsx)("button",{type:"button",style:{color:n?"#2d3a4b":"#b71c1c",background:"none",border:"1px solid "+(n?"#2d3a4b":"#b71c1c"),borderRadius:4,padding:"6px 16px",cursor:"pointer"},onClick:()=>t.push(n?"/login":"/admin/login"),children:n?"Switch to user login":"\u7ba1\u7406\u54e1\u767b\u5165"})}function P(e){let{setToken:t,setUser:n}=e;const c=Object(D.g)(),[a,r]=Object(s.useState)("login"),[i,l]=Object(s.useState)(""),[d,j]=Object(s.useState)(""),[b,h]=Object(s.useState)(""),[u,p]=Object(s.useState)(!1);return Object(o.jsxs)("div",{style:{maxWidth:350,margin:"40px auto",padding:24,border:"1px solid #ccc",borderRadius:8,background:"#fff",boxShadow:"0 2px 8px #eee"},children:[Object(o.jsx)("h1",{style:{textAlign:"center",marginBottom:18,color:"#2d3a4b",letterSpacing:2},children:"GPT \u77e5\u8b58\u7cfb\u7d71"}),Object(o.jsx)("h2",{style:{textAlign:"center",marginBottom:20},children:"login"===a?"\u767b\u5165":"\u8a3b\u518a"}),Object(o.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),h("");try{if("register"===a){const e=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:d})}),t=await e.json();e.ok?(h("\u8a3b\u518a\u6210\u529f\uff0c\u8acb\u767b\u5165"),r("login")):h(t.error||"\u8a3b\u518a\u5931\u6557")}else{const e=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,password:d})}),s=await e.json();e.ok?(t(s.token),n(i),localStorage.setItem("username",i)):h(s.error||"\u767b\u5165\u5931\u6557")}}catch(s){h("\u9023\u7dda\u932f\u8aa4")}},children:[Object(o.jsx)("div",{children:Object(o.jsx)("input",{type:"text",placeholder:"\u5e33\u865f",value:i,onChange:e=>l(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8},autoFocus:!0})}),Object(o.jsxs)("div",{style:{position:"relative"},children:[Object(o.jsx)("input",{type:u?"text":"password",placeholder:"\u5bc6\u78bc",value:d,onChange:e=>j(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8,paddingRight:36}}),!b&&Object(o.jsx)("span",{onClick:()=>p((e=>!e)),style:{position:"absolute",right:10,top:"50%",transform:"translateY(-50%)",cursor:"pointer",color:"#888",fontSize:18},title:u?"\u96b1\u85cf\u5bc6\u78bc":"\u986f\u793a\u5bc6\u78bc",tabIndex:0,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&p((e=>!e)),children:u?"\ud83d\ude48":"\ud83d\udc41\ufe0f"})]}),Object(o.jsx)("button",{type:"submit",style:{width:"100%",fontSize:16,padding:10,background:"#2d3a4b",color:"#fff",border:"none",borderRadius:4,marginTop:6},children:"login"===a?"\u767b\u5165":"\u8a3b\u518a"})]}),"/admin/login"!==c.pathname&&Object(o.jsx)("div",{style:{marginTop:10,textAlign:"center"},children:"login"===a?Object(o.jsxs)("span",{children:["\u9084\u6c92\u6709\u5e33\u865f\uff1f ",Object(o.jsx)("button",{type:"button",style:{color:"#2d3a4b",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},onClick:()=>r("register"),children:"\u8a3b\u518a"})]}):Object(o.jsxs)("span",{children:["\u5df2\u6709\u5e33\u865f\uff1f ",Object(o.jsx)("button",{type:"button",style:{color:"#2d3a4b",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},onClick:()=>r("login"),children:"\u767b\u5165"})]})}),Object(o.jsx)("div",{style:{marginTop:24,textAlign:"center"},children:Object(o.jsx)(R,{})}),b&&Object(o.jsx)("div",{style:{color:"red",marginTop:12,textAlign:"center"},children:b})]})}function q(){const e=Object(D.g)(),t=Object(D.f)(),n="/admin/login"===e.pathname;return Object(o.jsx)("button",{type:"button",style:{color:n?"#2d3a4b":"#b71c1c",background:"none",border:"1px solid "+(n?"#2d3a4b":"#b71c1c"),borderRadius:4,padding:"6px 16px",cursor:"pointer"},onClick:()=>t.push(n?"/login":"/admin/login"),children:n?"Switch to user login":"\u7ba1\u7406\u54e1\u767b\u5165"})}function $(e){let{setAdminToken:t,setAdminUser:n}=e;const c=Object(D.f)(),[a,r]=Object(s.useState)(""),[i,l]=Object(s.useState)(""),[d,j]=Object(s.useState)("");return Object(o.jsxs)("div",{style:{maxWidth:350,margin:"40px auto",padding:24,border:"1px solid #ccc",borderRadius:8,background:"#fff",boxShadow:"0 2px 8px #eee"},children:[Object(o.jsx)("h1",{style:{textAlign:"center",marginBottom:18,color:"#b71c1c",letterSpacing:2},children:"Admin Login"}),Object(o.jsx)("h2",{style:{textAlign:"center",marginBottom:20},children:"\u7ba1\u7406\u54e1\u767b\u5165"}),Object(o.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),j("");try{const e=await fetch("/api/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:i})}),s=await e.json();e.ok?(t(s.token),n(a),j("\u767b\u5165\u6210\u529f\uff0c\u6b63\u5728\u8df3\u8f49..."),c.push("/admin/dashboard")):401===e.status?j("\u50c5\u9650\u7ba1\u7406\u54e1\u767b\u5165"):j(s.error||"\u767b\u5165\u5931\u6557")}catch(s){j("\u9023\u7dda\u932f\u8aa4")}},children:[Object(o.jsx)("div",{children:Object(o.jsx)("input",{type:"text",placeholder:"\u5e33\u865f",value:a,onChange:e=>r(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8},autoFocus:!0})}),Object(o.jsx)("div",{children:Object(o.jsx)("input",{type:"password",placeholder:"\u5bc6\u78bc",value:i,onChange:e=>l(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8}})}),Object(o.jsx)("button",{type:"submit",style:{width:"100%",fontSize:16,padding:10,background:"#b71c1c",color:"#fff",border:"none",borderRadius:4,marginTop:6},children:"\u767b\u5165"})]}),Object(o.jsx)("div",{style:{marginTop:24,textAlign:"center"},children:Object(o.jsx)(q,{})}),d&&Object(o.jsx)("div",{style:{color:"red",marginTop:12,textAlign:"center"},children:d})]})}function L(e){let{adminUser:t}=e;const n=Object(D.f)();return Object(s.useEffect)((()=>{t||n.push("/admin/login")}),[t,n]),Object(o.jsxs)("div",{className:"admin-dashboard",children:[Object(o.jsx)("h1",{children:"\u7ba1\u7406\u54e1\u5f8c\u53f0"}),Object(o.jsx)("ul",{children:Object(o.jsx)("li",{children:Object(o.jsx)(r.b,{to:"/admin/qa",children:"\u554f\u7b54\u7ba1\u7406"})})})]})}function z(e){let{adminToken:t}=e;const[n,c]=Object(s.useState)([]),[a,r]=Object(s.useState)(""),[i,l]=Object(s.useState)("");Object(s.useEffect)((()=>{fetch("/api/questions",{headers:{Authorization:`Bearer ${t}`}}).then((e=>e.json())).then((e=>{e.success?c(e.questions||e.data||[]):r(e.error||"\u8b80\u53d6\u5931\u6557")})).catch((()=>r("\u9023\u7dda\u932f\u8aa4")))}),[t]);return Object(o.jsxs)("div",{className:"knowledge-base",style:{minHeight:"calc(100vh - 140px)"},children:[Object(o.jsx)("h1",{children:"\u554f\u7b54\u7ba1\u7406"}),a&&Object(o.jsx)("div",{style:{color:"red"},children:a}),Object(o.jsxs)("div",{className:"knowledge-controls",children:[Object(o.jsx)("input",{type:"text",placeholder:"\u641c\u5c0b\u554f\u984c...",value:i,onChange:e=>l(e.target.value),className:"search-box"}),Object(o.jsx)("button",{onClick:async()=>{try{const e=new URLSearchParams;i&&e.append("keyword",i);const n=await fetch(`/search?${e.toString()}`,{headers:{Authorization:`Bearer ${t}`}}),s=await n.json();s.success?c(s.data||[]):r(s.error||"\u641c\u5c0b\u5931\u6557")}catch{r("\u641c\u5c0b\u5931\u6557")}},style:{marginLeft:"8px"},children:"\u641c\u5c0b"})]}),Object(o.jsxs)("table",{className:"knowledge-table",children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"\u554f\u984c"}),Object(o.jsx)("th",{children:"\u5206\u985e"}),Object(o.jsx)("th",{children:"\u8b9a"}),Object(o.jsx)("th",{children:"\u65e5\u671f"}),Object(o.jsx)("th",{children:"\u64cd\u4f5c"})]})}),Object(o.jsx)("tbody",{children:n.map((e=>Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:e.question}),Object(o.jsx)("td",{children:e.category||"\u672a\u5206\u985e"}),Object(o.jsxs)("td",{children:["\ud83d\udc4d ",e.likes||0]}),Object(o.jsx)("td",{children:e.created_at?new Date(e.created_at).toLocaleDateString():""}),Object(o.jsx)("td",{children:Object(o.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u78ba\u5b9a\u8981\u522a\u9664\u9019\u500b\u554f\u984c\u55ce\uff1f"))try{const s=await fetch(`/api/questions/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),a=await s.json();a.success?c(n.filter((t=>t._id!==e))):r(a.error||"\u522a\u9664\u5931\u6557")}catch{r("\u9023\u7dda\u932f\u8aa4")}})(e._id),className:"delete-button",style:{backgroundColor:"#dc3545",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"\u2716\ufe0f \u522a\u9664"})})]},e._id)))})]})]})}n(510);const F=[{path:"/admin/dashboard",label:"\u7e3d\u89bd"},{path:"/admin/qa",label:"\u554f\u7b54\u7ba1\u7406"},{path:"/admin/user-management",label:"\u7528\u6236\u7ba1\u7406"},{path:"/admin/feedback-management",label:"\u53cd\u994b\u7ba1\u7406"}];function B(e){let{onLinkClick:t}=e;const n=Object(D.g)();return Object(o.jsx)("nav",{className:"admin-sidebar",children:Object(o.jsx)("ul",{children:F.map((e=>Object(o.jsx)("li",{className:n.pathname===e.path?"active":"",children:Object(o.jsx)(r.b,{to:e.path,onClick:t,children:e.label})},e.path)))})})}n(511);const U=Object({NODE_ENV:"production",PUBLIC_URL:"/GPT-Knowledge-System",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000";function K(){const e=Object(D.f)(),[t,n]=Object(s.useState)([]),[c,a]=Object(s.useState)(""),[r,i]=Object(s.useState)(!0),[l,d]=Object(s.useState)(null),[j,b]=Object(s.useState)(!1),[h,u]=Object(s.useState)({name:"",password:"",role:"user"}),[p,O]=Object(s.useState)(null),[x,m]=Object(s.useState)({name:"",password:"",role:"user"}),g=localStorage.getItem("token");Object(s.useEffect)((()=>{(async()=>{i(!0);try{const e=localStorage.getItem("token");if(!e)return console.error("No token found"),void d("Authentication required");console.log("Fetching users with token:",e);const t=await fetch(`${U}/api/users`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});console.log("Response status:",t.status);const s=await t.json();if(console.log("Response data:",s),403===t.status)return void d("You do not have permission to access this page");s.success?n((s.users||[]).map((e=>({id:e._id,name:e.username,role:e.role||(e.isAdmin?"admin":"user")})))):(console.error("Error in response:",s.error),d(s.error||"Failed to fetch users"))}catch(e){console.error("Fetch error:",e),d("Failed to fetch users: "+e.message)}finally{i(!1)}})()}),[e,g]);const f=t.filter((e=>e.name.toLowerCase().includes(c.toLowerCase()))),y=e=>{const{name:t,value:n}=e.target;m((e=>({...e,[t]:n})))},v=e=>{const{name:t,value:n}=e.target;u((e=>({...e,[t]:n})))};return r?Object(o.jsx)("div",{children:"Loading..."}):l?Object(o.jsxs)("div",{children:["Error: ",l]}):Object(o.jsxs)("div",{className:"admin-user-management",children:[Object(o.jsx)("h1",{children:"\u7528\u6236\u7ba1\u7406"}),Object(o.jsxs)("div",{className:"search-bar",children:[Object(o.jsx)("input",{type:"text",placeholder:"\u641c\u5c0b\u7528\u6236...",value:c,onChange:e=>{a(e.target.value)}}),Object(o.jsx)("button",{className:"add-user-btn",onClick:()=>b(!0),children:"\u65b0\u589e\u7528\u6236"})]}),j&&Object(o.jsxs)("div",{className:"add-user-form",children:[Object(o.jsx)("h2",{children:"\u65b0\u589e\u7528\u6236"}),Object(o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{i(!0);const e=await fetch(`${U}/api/register`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({username:h.name,password:h.password})}),s=await e.json();e.ok&&s.userId?("admin"===h.role&&await fetch(`${U}/api/users/${s.userId}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({role:"admin"})}),n([...t,{id:s.userId,name:h.name,role:h.role}]),u({name:"",password:"",role:"user"}),b(!1)):d(s.error||"Failed to add user")}catch(s){d("Failed to add user")}finally{i(!1)}},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"\u7528\u6236\u540d\uff1a"}),Object(o.jsx)("input",{type:"text",name:"name",value:h.name,onChange:v,required:!0})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"\u5bc6\u78bc\uff1a"}),Object(o.jsx)("input",{type:"password",name:"password",value:h.password,onChange:v,required:!0})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"\u89d2\u8272\uff1a"}),Object(o.jsxs)("select",{name:"role",value:h.role,onChange:v,children:[Object(o.jsx)("option",{value:"user",children:"\u4e00\u822c\u7528\u6236"}),Object(o.jsx)("option",{value:"admin",children:"\u7ba1\u7406\u54e1"})]})]}),Object(o.jsxs)("div",{className:"form-actions",children:[Object(o.jsx)("button",{type:"submit",className:"submit-btn",children:"\u65b0\u589e"}),Object(o.jsx)("button",{type:"button",className:"cancel-btn",onClick:()=>b(!1),children:"\u53d6\u6d88"})]})]})]}),p&&Object(o.jsxs)("div",{className:"edit-user-form add-user-form",children:[Object(o.jsx)("h2",{children:"\u7de8\u8f2f\u7528\u6236"}),Object(o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{i(!0);const e={role:x.role};x.name!==p.name&&(e.name=x.name),x.password&&(e.password=x.password);const s=await fetch(`${U}/api/users/${p.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(e)}),c=await s.json();c.success?(n(t.map((e=>e.id===p.id?{...e,name:x.name,role:x.role}:e))),O(null),m({name:"",password:"",role:"user"})):d(c.error||"Failed to update user")}catch(s){d("Failed to update user")}finally{i(!1)}},children:[Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"\u7528\u6236\u540d\uff1a"}),Object(o.jsx)("input",{type:"text",name:"name",value:x.name,onChange:y,required:!0})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"\u65b0\u5bc6\u78bc\uff1a"}),Object(o.jsx)("input",{type:"password",name:"password",value:x.password,onChange:y,placeholder:"\u7559\u7a7a\u8868\u793a\u4e0d\u4fee\u6539\u5bc6\u78bc"})]}),Object(o.jsxs)("div",{className:"form-group",children:[Object(o.jsx)("label",{children:"\u89d2\u8272\uff1a"}),Object(o.jsxs)("select",{name:"role",value:x.role,onChange:y,children:[Object(o.jsx)("option",{value:"user",children:"\u4e00\u822c\u7528\u6236"}),Object(o.jsx)("option",{value:"admin",children:"\u7ba1\u7406\u54e1"})]})]}),Object(o.jsxs)("div",{className:"form-actions",children:[Object(o.jsx)("button",{type:"submit",className:"submit-btn",children:"\u4fdd\u5b58"}),Object(o.jsx)("button",{type:"button",className:"cancel-btn",onClick:()=>{O(null),m({name:"",password:"",role:"user"})},children:"\u53d6\u6d88"})]})]})]}),Object(o.jsx)("div",{className:"user-list",children:Object(o.jsxs)("table",{children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"\u7528\u6236\u540d"}),Object(o.jsx)("th",{children:"\u89d2\u8272"}),Object(o.jsx)("th",{children:"\u64cd\u4f5c"})]})}),Object(o.jsx)("tbody",{children:f.map((e=>Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:e.name}),Object(o.jsx)("td",{children:"admin"===e.role?"\u7ba1\u7406\u54e1":"\u4e00\u822c\u7528\u6236"}),Object(o.jsxs)("td",{children:[Object(o.jsx)("button",{onClick:()=>(async(e,s)=>{try{i(!0);const c="admin"===s?"user":"admin",a=await fetch(`${U}/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({role:c})}),r=await a.json();r.success?n(t.map((t=>t.id===e?{...t,role:c}:t))):d(r.error||"Failed to update user role")}catch(c){d("Failed to update user role")}finally{i(!1)}})(e.id,e.role),className:"admin"===e.role?"remove-admin":"make-admin",children:"admin"===e.role?"\u53d6\u6d88\u7ba1\u7406\u54e1":"\u8a2d\u70ba\u7ba1\u7406\u54e1"}),Object(o.jsx)("button",{onClick:()=>(e=>{O(e),m({name:e.name,password:"",role:e.role})})(e),className:"edit-user",children:"\u7de8\u8f2f"}),Object(o.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{i(!0);const s=await fetch(`${U}/api/users/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${g}`}}),c=await s.json();c.success?n(t.filter((t=>t.id!==e))):d(c.error||"Failed to delete user")}catch(s){d("Failed to delete user")}finally{i(!1)}})(e.id),className:"delete-user",children:"\u522a\u9664"})]})]},e.id)))})]})})]})}const J=Object({NODE_ENV:"production",PUBLIC_URL:"/GPT-Knowledge-System",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000";function W(){Object(D.f)();const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)(!0),[a,r]=Object(s.useState)(null),i=localStorage.getItem("token");Object(s.useEffect)((()=>{(async()=>{c(!0);try{const e=await fetch(`${J}/api/feedback`,{headers:{Authorization:`Bearer ${i}`}}),n=await e.json();n.success?t(n.feedbacks||[]):r(n.error||"Failed to fetch feedback")}catch(e){r("Failed to fetch feedback: "+e.message)}finally{c(!1)}})()}),[i]);return n?Object(o.jsx)("div",{children:"\u8f09\u5165\u4e2d..."}):a?Object(o.jsxs)("div",{style:{color:"red"},children:["Error: ",a]}):Object(o.jsxs)("div",{style:{padding:"24px"},children:[Object(o.jsx)("h2",{children:"\u53cd\u994b\u7ba1\u7406"}),Object(o.jsxs)("table",{border:"1",cellPadding:"8",style:{width:"100%",marginTop:"16px"},children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"\u7528\u6236\u540d"}),Object(o.jsx)("th",{children:"\u5167\u5bb9"}),Object(o.jsx)("th",{children:"\u63d0\u4ea4\u6642\u9593"}),Object(o.jsx)("th",{children:"\u64cd\u4f5c"})]})}),Object(o.jsx)("tbody",{children:0===e.length?Object(o.jsx)("tr",{children:Object(o.jsx)("td",{colSpan:"4",children:"\u66ab\u7121\u53cd\u994b"})}):e.map((n=>Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{children:n.username}),Object(o.jsx)("td",{children:n.content}),Object(o.jsx)("td",{children:new Date(n.created_at).toLocaleString()}),Object(o.jsx)("td",{children:Object(o.jsx)("button",{onClick:()=>(async n=>{if(window.confirm("\u78ba\u5b9a\u8981\u522a\u9664\u6b64\u53cd\u994b\u55ce\uff1f")){c(!0);try{const s=await fetch(`${J}/api/feedback/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}}),c=await s.json();c.success?t(e.filter((e=>e._id!==n))):r(c.error||"Failed to delete feedback")}catch(s){r("Failed to delete feedback: "+s.message)}finally{c(!1)}}})(n._id),style:{color:"red"},children:"\u522a\u9664"})})]},n._id)))})]})]})}var H=n(149);var M=function(){const[e,t]=Object(s.useState)((()=>localStorage.getItem("token")||"")),[n,c]=Object(s.useState)(!1),[a]=Object(s.useState)(""),r=()=>c((e=>!e)),l=e=>{t(e),localStorage.setItem("token",e);try{const t=Object(H.a)(e);!t||!0!==t.isAdmin&&"admin"!==t.role?window.location.replace("/"):window.location.replace("/admin/dashboard")}catch(n){window.location.replace("/")}},d=()=>{t(""),localStorage.removeItem("token")},j=Object(D.g)();if(!e)return"/admin/login"!==j.pathname&&"/login"!==j.pathname?(window.location.replace("/login"),null):"/admin/login"===j.pathname?Object(o.jsx)($,{setAdminToken:l,setAdminUser:()=>{}}):Object(o.jsx)(P,{setToken:l});let u=!1;try{const t=Object(H.a)(e);u=t&&(!0===t.isAdmin||"admin"===t.role)}catch(p){u=!1}return u&&!j.pathname.startsWith("/admin")?(window.location.replace("/admin/dashboard"),null):!u&&j.pathname.startsWith("/admin")?(window.location.replace("/"),null):u?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("button",{className:"hamburger",onClick:r,children:"\u2630"}),Object(o.jsx)("button",{onClick:d,style:{position:"absolute",top:10,right:10,zIndex:1e3,background:"#f44336",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 16px",cursor:"pointer"},children:"\u767b\u51fa"}),Object(o.jsxs)("div",{className:"app-container",children:[Object(o.jsx)(B,{}),Object(o.jsx)("div",{className:"content",style:{marginLeft:200},children:Object(o.jsxs)(D.c,{children:[Object(o.jsx)(D.a,{exact:!0,path:"/admin/dashboard",component:L}),Object(o.jsx)(D.a,{path:"/admin/qa",render:()=>Object(o.jsx)(z,{adminToken:e})}),Object(o.jsx)(D.a,{path:"/admin/user-management",component:K}),Object(o.jsx)(D.a,{path:"/admin/feedback-management",component:W})]})})]})]}):Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("button",{className:"hamburger",onClick:r,children:"\u2630"}),Object(o.jsx)("button",{onClick:d,style:{position:"absolute",top:10,right:10,zIndex:1e3,background:"#f44336",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 16px",cursor:"pointer"},children:"\u767b\u51fa"}),Object(o.jsxs)("div",{className:"app-container",children:[Object(o.jsx)(i,{isOpen:n,onLinkClick:()=>c(!1)}),Object(o.jsx)("div",{className:"content",children:Object(o.jsxs)(D.c,{children:[Object(o.jsx)(D.a,{exact:!0,path:"/",component:I}),Object(o.jsx)(D.a,{path:"/knowledge",component:b}),Object(o.jsx)(D.a,{path:"/documents",render:()=>Object(o.jsx)(h,{user:a})}),Object(o.jsx)(D.a,{path:"/collaboration",component:x}),Object(o.jsx)(D.a,{path:"/analytics",component:E}),Object(o.jsx)(D.a,{path:"/feedback",component:_})]})})]})]})};a.a.render(Object(o.jsx)(r.a,{children:Object(o.jsx)(M,{})}),document.getElementById("root"))}},[[512,1,2]]]);
//# sourceMappingURL=main.747d5699.chunk.js.map