(this["webpackJsonpgpt-knowledge-system"]=this["webpackJsonpgpt-knowledge-system"]||[]).push([[0],{153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){},281:function(e,t,n){},282:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},298:function(e,t,n){},510:function(e,t,n){},511:function(e,t,n){},512:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(67),a=n.n(c),r=n(19),o=(n(281),n(282),n(153),n(154),n(155),n(21)),i=n(1);var l=function(e){let{isOpen:t,onLinkClick:n}=e;return Object(i.jsx)("nav",{className:"sidebar "+(t?"active":""),children:Object(i.jsxs)("ul",{children:[Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/",onClick:n,children:"\u9996\u9801"})}),Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/knowledge",onClick:n,children:"\u77e5\u8b58\u5eab"})}),Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/documents",onClick:n,children:"\u6587\u6a94\u7ba1\u7406"})}),Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/collaboration",onClick:n,children:"\u5354\u4f5c\u4e2d\u5fc3"})}),Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/analytics",onClick:n,children:"\u6578\u64da\u5206\u6790"})}),Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/feedback",onClick:n,children:"\u53cd\u994b"})})]})})},d=n(517);const j=d.a.create({baseURL:"http://localhost:5000",headers:{"Content-Type":"application/json"}});j.interceptors.request.use((e=>(console.log("API Request:",e.method.toUpperCase(),e.url),e)),(e=>(console.error("API Request Error:",e),Promise.reject(e)))),j.interceptors.response.use((e=>(console.log("API Response:",e.config.url,e.data),e)),(e=>{var t;return console.error("API Response Error:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message),Promise.reject(e)}));var b=j;var h=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)([]),[a,r]=Object(s.useState)(""),[o,l]=Object(s.useState)("likes"),[d,b]=Object(s.useState)(null),[h,u]=Object(s.useState)(!1),[O,p]=Object(s.useState)("\u5168\u90e8");Object(s.useEffect)((()=>{(async()=>{try{const e=await j.get("/api/questions");console.log("Fetched questions:",e.data.data);const n=(e.data.data||[]).map((e=>({...e,likes:e.likes||0})));t(n),x(n,a,o)}catch(e){console.error("Error fetching questions:",e)}})()}),[a,o]);const x=(e,t,n)=>{let s=e.filter((e=>e.question.toLowerCase().includes(t.toLowerCase())));"likes"===n?s.sort(((e,t)=>t.likes-e.likes)):"newest"===n&&s.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),c(s)};return Object(i.jsxs)("div",{className:"knowledge-base",style:{minHeight:"calc(100vh - 140px)"},children:[Object(i.jsx)("h1",{children:"\u77e5\u8b58\u5eab"}),Object(i.jsxs)("div",{className:"knowledge-controls",children:[Object(i.jsx)("input",{type:"text",placeholder:"\u641c\u5c0b\u554f\u984c...",value:a,onChange:e=>r(e.target.value),className:"search-box"}),Object(i.jsx)("select",{value:O,onChange:e=>p(e.target.value),className:"sort-dropdown",children:["\u5168\u90e8","IT","\u4eba\u8cc7","\u8ca1\u52d9","\u884c\u653f","\u7e3d\u52d9","\u6cd5\u52d9","\u63a1\u8cfc","\u7814\u767c","\u884c\u92b7","\u5ba2\u670d","\u77e5\u8b58\u7ba1\u7406"].map((e=>Object(i.jsx)("option",{value:e,children:e},e)))}),Object(i.jsx)("button",{onClick:async()=>{try{const e=new URLSearchParams;a&&e.append("keyword",a),O&&"\u5168\u90e8"!==O&&e.append("category",O);const n=await j.get(`/search?${e.toString()}`);t(n.data.data||[]),x(n.data.data||[],a,o)}catch(e){console.error("\u641c\u5c0b\u5931\u6557:",e),alert("\u641c\u5c0b\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66")}},style:{marginLeft:"8px"},children:"\u641c\u5c0b"}),Object(i.jsxs)("select",{className:"sort-dropdown",value:o,onChange:e=>l(e.target.value),children:[Object(i.jsx)("option",{value:"likes",children:"\u71b1\u9580"}),Object(i.jsx)("option",{value:"newest",children:"\u6700\u65b0"})]})]}),Object(i.jsxs)("table",{className:"knowledge-table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"\u554f\u984c"}),Object(i.jsx)("th",{children:"\u5206\u985e"}),Object(i.jsx)("th",{children:"\u8b9a"}),Object(i.jsx)("th",{children:"\u65e5\u671f"})]})}),Object(i.jsx)("tbody",{children:n.map(((e,t)=>Object(i.jsxs)("tr",{onClick:()=>(b(e),void u(!0)),children:[Object(i.jsx)("td",{children:e.question}),Object(i.jsx)("td",{children:e.category||"\u672a\u5206\u985e"}),Object(i.jsx)("td",{children:Object(i.jsxs)("span",{style:{backgroundColor:"#e3f2fd",border:"1px solid #e0e0e0",padding:"8px 16px",borderRadius:"4px",cursor:"default",display:"flex",alignItems:"center",gap:"5px"},children:["\ud83d\udc4d ",e.likes]})}),Object(i.jsx)("td",{children:new Date(e.created_at).toLocaleDateString()})]},e._id)))})]}),h&&d&&Object(i.jsx)("div",{className:"modal-overlay",onClick:()=>u(!1),children:Object(i.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Object(i.jsx)("h2",{children:d.question}),Object(i.jsx)("p",{children:d.answer}),Object(i.jsxs)("div",{className:"modal-actions",children:[Object(i.jsxs)("button",{onClick:()=>(async n=>{try{if(!(await j.post(`/api/questions/${n}/like`)).data.success)throw new Error("\u9ede\u8b9a\u5931\u6557");const s=e.map((e=>e._id===n?{...e,likes:e.likes+1}:e));t(s),x(s,a,o)}catch(r){var s,c;console.error("Error liking question:",r),alert("\u9ede\u8b9a\u5931\u6557\uff1a"+((null===(s=r.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.error)||"\u8acb\u7a0d\u5f8c\u518d\u8a66"))}})(d._id),style:{backgroundColor:"#e3f2fd",color:"#000",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"default",marginRight:"10px",pointerEvents:"none"},children:["\ud83d\udc4d \u9ede\u8b9a (",d.likes,")"]}),Object(i.jsx)("button",{onClick:()=>{u(!1),b(null)},style:{backgroundColor:"#6c757d",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},children:"\u95dc\u9589"})]})]})})]})};var u=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)(!1),a=async()=>{try{const e=await fetch("/api/files"),n=await e.json();n.success?t(n.files):t([])}catch{t([])}};return Object(s.useEffect)((()=>{a()}),[]),Object(i.jsxs)("div",{className:"document-management",children:[Object(i.jsx)("h1",{children:"\u6587\u6a94\u7ba1\u7406"}),Object(i.jsx)("div",{className:"upload-section",children:Object(i.jsx)("input",{type:"file",onChange:async e=>{const t=e.target.files[0];if(!t)return;c(!0);const n=new FormData;n.append("file",t);try{const e=localStorage.getItem("token"),t=await fetch("/api/upload",{method:"POST",headers:e?{Authorization:"Bearer "+e}:{},body:n}),s=await t.json();s.success?(a(),alert("\u4e0a\u50b3\u6210\u529f")):alert(s.error||"\u4e0a\u50b3\u5931\u6557")}catch{alert("\u4e0a\u50b3\u5931\u6557")}c(!1)},className:"file-input",disabled:n})}),Object(i.jsxs)("div",{className:"file-list",children:[Object(i.jsx)("h2",{children:"\u5df2\u4e0a\u50b3\u6587\u4ef6"}),Object(i.jsx)("ul",{children:e.map(((e,t)=>Object(i.jsxs)("li",{className:"file-item",children:[Object(i.jsx)("span",{className:"file-name",children:e.filename}),Object(i.jsxs)("span",{style:{marginLeft:12,color:"#888",fontSize:14},children:["\u4e0a\u50b3\u8005\uff1a",e.uploader||"\u672a\u77e5"]}),Object(i.jsx)("span",{style:{marginLeft:12,color:"#888",fontSize:14},children:e.upload_time?new Date(e.upload_time).toLocaleString():""}),Object(i.jsx)("a",{className:"download-btn",href:`/api/download/${encodeURIComponent(e.filename)}`,download:e.filename,style:{marginLeft:12},children:"\u4e0b\u8f09"})]},t)))})]})]})},O=(n(295),n(113));n(296);const p={todo:[],inProgress:[],done:[]};var x=()=>{const[e,t]=Object(s.useState)(p),[n,c]=Object(s.useState)(""),[a,r]=Object(s.useState)("todo");return Object(i.jsxs)("div",{className:"task-board-container",children:[Object(i.jsx)("h2",{children:"\ud83d\udcdd \u4efb\u52d9\u770b\u677f"}),Object(i.jsxs)("form",{onSubmit:s=>{if(s.preventDefault(),!n.trim())return;const r={id:Date.now().toString(),content:n.trim()};t({...e,[a]:[...e[a],r]}),c("")},style:{marginBottom:16,display:"flex",gap:8},children:[Object(i.jsx)("input",{type:"text",placeholder:"\u8f38\u5165\u65b0\u4efb\u52d9\u5167\u5bb9...",value:n,onChange:e=>c(e.target.value),style:{flex:1,fontSize:16,padding:8}}),Object(i.jsxs)("select",{value:a,onChange:e=>r(e.target.value),style:{fontSize:16,padding:8},children:[Object(i.jsx)("option",{value:"todo",children:"\u5f85\u8655\u7406"}),Object(i.jsx)("option",{value:"inProgress",children:"\u9032\u884c\u4e2d"}),Object(i.jsx)("option",{value:"done",children:"\u5df2\u5b8c\u6210"})]}),Object(i.jsx)("button",{type:"submit",style:{fontSize:16,padding:"8px 16px"},children:"\u65b0\u589e\u4efb\u52d9"})]}),Object(i.jsx)(O.a,{onDragEnd:n=>{const{source:s,destination:c}=n;if(!c)return;const a=Array.from(e[s.droppableId]),r=Array.from(e[c.droppableId]),[o]=a.splice(s.index,1);s.droppableId===c.droppableId?(a.splice(c.index,0,o),t({...e,[s.droppableId]:a})):(r.splice(c.index,0,o),t({...e,[s.droppableId]:a,[c.droppableId]:r}))},children:Object(i.jsx)("div",{className:"task-columns",children:Object.entries(e).map((n=>{let[s,c]=n;return Object(i.jsx)(O.c,{droppableId:s,children:n=>Object(i.jsxs)("div",{className:"task-column",ref:n.innerRef,...n.droppableProps,children:[Object(i.jsx)("h3",{children:"todo"===s?"\ud83d\udccc \u5f85\u8655\u7406":"inProgress"===s?"\ud83d\udea7 \u9032\u884c\u4e2d":"\u2705 \u5df2\u5b8c\u6210"}),c.map(((n,c)=>Object(i.jsx)(O.b,{draggableId:n.id,index:c,children:c=>Object(i.jsxs)("div",{className:"task-card",ref:c.innerRef,...c.draggableProps,...c.dragHandleProps,style:{display:"flex",alignItems:"center",gap:8,...c.draggableProps.style},children:[Object(i.jsx)("span",{style:{flex:1},children:n.content}),Object(i.jsx)("button",{onClick:()=>((n,s)=>{t({...e,[n]:e[n].filter((e=>e.id!==s))})})(s,n.id),style:{background:"#ff4d4f",color:"#fff",border:"none",borderRadius:4,padding:"2px 8px",cursor:"pointer"},title:"\u522a\u9664\u4efb\u52d9",children:"\u522a\u9664"})]})},n.id))),n.placeholder]})},s)}))})})]})};var m=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)("");return Object(i.jsx)("div",{className:"collaboration-container",children:Object(i.jsxs)("div",{className:"content-wrapper",children:[Object(i.jsx)("h1",{className:"collaboration-title",children:"\ud83d\udfe3 \u5354\u4f5c\u4e2d\u5fc3"}),Object(i.jsx)(x,{}),Object(i.jsx)("h2",{className:"section-title",children:"\ud83d\udcdd \u7559\u8a00\u8a0e\u8ad6\u5340"}),Object(i.jsxs)("div",{className:"comment-section",children:[Object(i.jsx)("div",{className:"comment-list",children:e.map((e=>Object(i.jsxs)("div",{className:"comment",children:[Object(i.jsxs)("strong",{children:[e.user,"\uff1a"]})," ",e.text]},e.id)))}),Object(i.jsxs)("div",{className:"comment-input",children:[Object(i.jsx)("textarea",{value:n,onChange:e=>c(e.target.value),placeholder:"\u7559\u4e0b\u4f60\u7684\u8a0e\u8ad6\u7559\u8a00..."}),Object(i.jsx)("button",{onClick:()=>{if(""!==n.trim()){const s={id:e.length+1,user:"\u4f60",text:n};t([...e,s]),c("")}},children:"\u9001\u51fa"})]})]})]})})},g=n(514),f=n(515),y=n(110),v=n(111),w=n(54),k=n(73),S=n(270),C=n(516),N=n(112),T=n(518),A=n(271),E=n(109);n(298);var I=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)([]),[a,r]=Object(s.useState)([]),[o,l]=Object(s.useState)([]),[d,j]=Object(s.useState)("monthly");Object(s.useEffect)((()=>{fetch("/api/questions").then((e=>e.json())).then((e=>{const n=e.data||[];if("weekly"===d){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=Array(7).fill(0);n.forEach((e=>{const t=new Date(e.created_at);s[t.getDay()]++})),t(e.map(((e,t)=>({date:e,count:s[t]}))))}else{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=Array(12).fill(0);n.forEach((e=>{const t=new Date(e.created_at);s[t.getMonth()]++})),t(e.map(((e,t)=>({date:e,count:s[t]}))))}const s={};n.forEach((e=>{const t=e.category||"\u672a\u5206\u985e";s[t]=(s[t]||0)+(e.likes||0)})),c(Object.entries(s).map((e=>{let[t,n]=e;return{category:t,likes:n}})));const a={};n.forEach((e=>{const t=e.category||"\u672a\u5206\u985e";a[t]=(a[t]||0)+1})),r(Object.entries(a).map((e=>{let[t,n]=e;return{name:t,value:n}})));const o={};n.forEach((e=>{const t=e.username||e.user||e.uploader||"";t&&(o[t]=(o[t]||0)+1)})),l(Object.entries(o).map((e=>{let[t,n]=e;return{username:t,count:n}})).sort(((e,t)=>t.count-e.count)).slice(0,10))}))}),[d]);const b=["#8884d8","#82ca9d","#ffc658","#ff8042"];return Object(i.jsxs)("div",{className:"data-analysis",children:[Object(i.jsx)("h1",{children:"\ud83d\udcca \u6578\u64da\u5206\u6790"}),Object(i.jsxs)("div",{className:"time-filter",children:[Object(i.jsx)("label",{children:"\u6642\u9593\u7bc4\u570d\uff1a"}),Object(i.jsxs)("select",{value:d,onChange:e=>j(e.target.value),children:[Object(i.jsx)("option",{value:"weekly",children:"\u8fd1\u4e00\u9031"}),Object(i.jsx)("option",{value:"monthly",children:"\u8fd1\u4e00\u6708"})]})]}),Object(i.jsx)("section",{children:Object(i.jsxs)("div",{className:"analysis-section",children:[Object(i.jsx)("h2",{children:"\ud83d\udfe2 \u554f\u7b54\u91cf\u8da8\u52e2"}),Object(i.jsxs)(g.a,{width:600,height:300,data:e,children:[Object(i.jsx)(f.a,{strokeDasharray:"3 3"}),Object(i.jsx)(y.a,{dataKey:"date"}),Object(i.jsx)(v.a,{allowDecimals:!1}),Object(i.jsx)(w.a,{}),Object(i.jsx)(k.a,{}),Object(i.jsx)(S.a,{type:"monotone",dataKey:"count",stroke:"#007bff",activeDot:{r:8}})]})]})}),Object(i.jsx)("section",{children:Object(i.jsxs)("div",{className:"analysis-section",children:[Object(i.jsx)("h2",{children:"\ud83d\udfe1 \u5404\u5206\u985e\u9ede\u8b9a\u6578"}),Object(i.jsxs)(C.a,{width:600,height:300,data:n,children:[Object(i.jsx)(f.a,{strokeDasharray:"3 3"}),Object(i.jsx)(y.a,{dataKey:"category"}),Object(i.jsx)(v.a,{}),Object(i.jsx)(w.a,{}),Object(i.jsx)(N.a,{dataKey:"likes",fill:"#ff8042"})]})]})}),Object(i.jsx)("section",{children:Object(i.jsxs)("div",{className:"analysis-section",children:[Object(i.jsx)("h2",{children:"\ud83d\udd35 \u6700\u53d7\u6b61\u8fce\u5206\u985e"}),Object(i.jsxs)(T.a,{width:400,height:300,children:[Object(i.jsx)(A.a,{data:a,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"value",label:!0,children:a.map(((e,t)=>Object(i.jsx)(E.a,{fill:b[t%b.length]},`cell-${t}`)))}),Object(i.jsx)(w.a,{})]})]})}),Object(i.jsx)("section",{children:Object(i.jsxs)("div",{className:"analysis-section",children:[Object(i.jsx)("h2",{children:"\ud83d\udc64 \u4f7f\u7528\u8005\u6d3b\u8e8d\u6392\u884c\u699c"}),Object(i.jsxs)("table",{className:"active-users-table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"#"}),Object(i.jsx)("th",{children:"\u4f7f\u7528\u8005"}),Object(i.jsx)("th",{children:"\u554f\u7b54\u6578"})]})}),Object(i.jsx)("tbody",{children:o.map(((e,t)=>Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:t+1}),Object(i.jsx)("td",{children:e.username}),Object(i.jsx)("td",{children:e.count})]},e.username)))})]})]})})]})};var _=function(){const[e,t]=Object(s.useState)(""),[n,c]=Object(s.useState)(""),[a,r]=Object(s.useState)(0),[o,l]=Object(s.useState)(!1),[d,j]=Object(s.useState)(!1),[h,u]=Object(s.useState)(null),[O,p]=Object(s.useState)(null),[x,m]=Object(s.useState)(!1),[g,f]=Object(s.useState)("");return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)("h1",{children:"AI \u77e5\u8b58\u5eab\u554f\u7b54\u7cfb\u7d71"}),Object(i.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),e.trim()){l(!0),u(""),c(""),m(!1),r(0),j(!1);try{let n=localStorage.getItem("username")||"anonymous";const s=await b.post("/ask",{question:e,username:n});if(c(s.data.answer||""),f(s.data.category||""),p(s.data.questionId),void 0!==s.data.likes&&r(s.data.likes),s.data.isCollected?m(!0):m(!1),!s.data.questionId)throw new Error("\u672a\u6536\u5230\u554f\u984c ID");localStorage.setItem("currentQuestionId",s.data.questionId),u(null),t("")}catch(h){console.error("Error:",h),"\u672a\u6536\u5230\u554f\u984c ID"!==h.message&&(u(h.message||"\u767c\u751f\u932f\u8aa4\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"),alert(h.message||"\u767c\u751f\u932f\u8aa4\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"))}finally{l(!1)}}else alert("\u8acb\u8f38\u5165\u554f\u984c")},className:"question-box",children:[Object(i.jsx)("textarea",{placeholder:"\u8acb\u8f38\u5165\u60a8\u7684\u554f\u984c...",value:e,onChange:e=>t(e.target.value),disabled:o}),Object(i.jsx)("button",{type:"submit",disabled:o,children:o?"\u6b63\u5728\u601d\u8003...":"\u2728 \u63d0\u554f"})]}),n&&Object(i.jsxs)("div",{className:"answer-box",children:[Object(i.jsx)("h2",{children:"\u2728 AI \u56de\u7b54\uff1a"}),Object(i.jsx)("p",{children:n}),Object(i.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"15px"},children:[Object(i.jsx)("button",{onClick:()=>{if(!x)return r(a+1),j(!0),void alert("\u6b64\u554f\u984c\u5c1a\u672a\u6536\u85cf\uff0c\u9ede\u8b9a\u50c5\u66ab\u5b58\u65bc\u672c\u5730");(async()=>{try{const e=O||localStorage.getItem("currentQuestionId");if(!e)return r(a+1),j(!0),void alert("\u6b64\u554f\u984c\u5c1a\u672a\u6536\u85cf\uff0c\u9ede\u8b9a\u50c5\u66ab\u5b58\u65bc\u672c\u5730");const t=await b.post(`/api/questions/${e}/like`);if(!t.data.success)throw new Error(t.data.error||"\u9ede\u8b9a\u5931\u6557");r(a+1),j(!0),u(null)}catch(h){console.error("Error liking:",h),u(h.message||"\u9ede\u8b9a\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"),alert(h.message||"\u9ede\u8b9a\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66")}})()},disabled:d,title:x?"":"\u6b64\u554f\u984c\u5c1a\u672a\u6536\u85cf\uff0c\u9ede\u8b9a\u50c5\u66ab\u5b58\u65bc\u672c\u5730",children:d?"\u5df2\u9ede\u8b9a":`\ud83d\udc4d \u9ede\u8b9a (${a})`}),Object(i.jsx)("button",{onClick:async()=>{try{if(!n)throw new Error("\u6c92\u6709\u53ef\u6536\u85cf\u7684\u7b54\u6848");if(x)return void alert("\u6b64\u554f\u984c\u5df2\u6536\u85cf\u5230\u6578\u64da\u5eab");const s=await b.post("/collect",{question:e,answer:n,category:g,likes:a});var t;if(!s.data||s.data.error)throw new Error((null===(t=s.data)||void 0===t?void 0:t.error)||"\u6536\u85cf\u5931\u6557");m(!0),"/knowledge"===window.location.pathname?window.location.reload():window.location.href="/knowledge"}catch(h){console.error("Error saving:",h),u(h.message||"\u6536\u85cf\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66"),alert(h.message||"\u6536\u85cf\u5931\u6557\uff1a\u8acb\u7a0d\u5f8c\u518d\u8a66")}},disabled:x||!n,children:x?"\u5df2\u6536\u85cf":"\u2728 \u6536\u85cf\u5230\u6578\u64da\u5eab"})]})]}),h&&Object(i.jsx)("div",{style:{color:"red",marginTop:"20px"},children:"\u672a\u6536\u5230\u554f\u984c ID"===h?null:h})]})};var D=()=>{const[e,t]=Object(s.useState)(""),[n,c]=Object(s.useState)(""),a=localStorage.getItem("username")||"anonymous";return Object(i.jsxs)("div",{style:{maxWidth:600,margin:"0 auto",padding:24},children:[Object(i.jsx)("h2",{style:{textAlign:"center"},children:"\u53cd\u994b"}),Object(i.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),e.trim())try{await d.a.post("/api/feedback",{username:a,feedback:e.trim()}),c("\u611f\u8b1d\u60a8\u7684\u53cd\u994b\uff01"),t("")}catch(s){c("\u9001\u51fa\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")}else c("\u8acb\u8f38\u5165\u60a8\u7684\u53cd\u994b\u5167\u5bb9\u3002")},children:[Object(i.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"\u8acb\u8f38\u5165\u60a8\u7684\u53cd\u994b...",rows:6,style:{width:"100%",marginBottom:16,resize:"vertical"}}),Object(i.jsx)("div",{style:{textAlign:"center"},children:Object(i.jsx)("button",{type:"submit",style:{background:"#4caf50",color:"#fff",padding:"8px 24px",border:"none",borderRadius:4},children:"\u9001\u51fa\u53cd\u994b"})})]}),n&&Object(i.jsx)("div",{style:{textAlign:"center",color:n.includes("\u611f\u8b1d")?"green":"red",marginTop:12},children:n})]})};function P(){const e=Object(r.g)(),t=Object(r.f)(),n="/admin/login"===e.pathname;return Object(i.jsx)("button",{type:"button",style:{color:n?"#2d3a4b":"#b71c1c",background:"none",border:"1px solid "+(n?"#2d3a4b":"#b71c1c"),borderRadius:4,padding:"6px 16px",cursor:"pointer"},onClick:()=>t.push(n?"/login":"/admin/login"),children:n?"Switch to user login":"\u7ba1\u7406\u54e1\u767b\u5165"})}function R(e){let{setToken:t,setUser:n}=e;const c=Object(r.g)(),[a,o]=Object(s.useState)("login"),[l,d]=Object(s.useState)(""),[j,b]=Object(s.useState)(""),[h,u]=Object(s.useState)(""),[O,p]=Object(s.useState)(!1);return Object(i.jsxs)("div",{style:{maxWidth:350,margin:"40px auto",padding:24,border:"1px solid #ccc",borderRadius:8,background:"#fff",boxShadow:"0 2px 8px #eee"},children:[Object(i.jsx)("h1",{style:{textAlign:"center",marginBottom:18,color:"#2d3a4b",letterSpacing:2},children:"GPT \u77e5\u8b58\u7cfb\u7d71"}),Object(i.jsx)("h2",{style:{textAlign:"center",marginBottom:20},children:"login"===a?"\u767b\u5165":"\u8a3b\u518a"}),Object(i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u("");try{if("register"===a){const e=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:j})}),t=await e.json();e.ok?(u("\u8a3b\u518a\u6210\u529f\uff0c\u8acb\u767b\u5165"),o("login")):u(t.error||"\u8a3b\u518a\u5931\u6557")}else{const e=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:l,password:j})}),s=await e.json();e.ok?(t(s.token),n(l),localStorage.setItem("username",l)):u(s.error||"\u767b\u5165\u5931\u6557")}}catch(s){u("\u9023\u7dda\u932f\u8aa4")}},children:[Object(i.jsx)("div",{children:Object(i.jsx)("input",{type:"text",placeholder:"\u5e33\u865f",value:l,onChange:e=>d(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8},autoFocus:!0})}),Object(i.jsxs)("div",{style:{position:"relative"},children:[Object(i.jsx)("input",{type:O?"text":"password",placeholder:"\u5bc6\u78bc",value:j,onChange:e=>b(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8,paddingRight:36}}),!h&&Object(i.jsx)("span",{onClick:()=>p((e=>!e)),style:{position:"absolute",right:10,top:"50%",transform:"translateY(-50%)",cursor:"pointer",color:"#888",fontSize:18},title:O?"\u96b1\u85cf\u5bc6\u78bc":"\u986f\u793a\u5bc6\u78bc",tabIndex:0,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&p((e=>!e)),children:O?"\ud83d\ude48":"\ud83d\udc41\ufe0f"})]}),Object(i.jsx)("button",{type:"submit",style:{width:"100%",fontSize:16,padding:10,background:"#2d3a4b",color:"#fff",border:"none",borderRadius:4,marginTop:6},children:"login"===a?"\u767b\u5165":"\u8a3b\u518a"})]}),"/admin/login"!==c.pathname&&Object(i.jsx)("div",{style:{marginTop:10,textAlign:"center"},children:"login"===a?Object(i.jsxs)("span",{children:["\u9084\u6c92\u6709\u5e33\u865f\uff1f ",Object(i.jsx)("button",{type:"button",style:{color:"#2d3a4b",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},onClick:()=>o("register"),children:"\u8a3b\u518a"})]}):Object(i.jsxs)("span",{children:["\u5df2\u6709\u5e33\u865f\uff1f ",Object(i.jsx)("button",{type:"button",style:{color:"#2d3a4b",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},onClick:()=>o("login"),children:"\u767b\u5165"})]})}),Object(i.jsx)("div",{style:{marginTop:24,textAlign:"center"},children:Object(i.jsx)(P,{})}),h&&Object(i.jsx)("div",{style:{color:"red",marginTop:12,textAlign:"center"},children:h})]})}function q(){const e=Object(r.g)(),t=Object(r.f)(),n="/admin/login"===e.pathname;return Object(i.jsx)("button",{type:"button",style:{color:n?"#2d3a4b":"#b71c1c",background:"none",border:"1px solid "+(n?"#2d3a4b":"#b71c1c"),borderRadius:4,padding:"6px 16px",cursor:"pointer"},onClick:()=>t.push(n?"/login":"/admin/login"),children:n?"Switch to user login":"\u7ba1\u7406\u54e1\u767b\u5165"})}function $(e){let{setAdminToken:t,setAdminUser:n}=e;const c=Object(r.f)(),[a,o]=Object(s.useState)(""),[l,d]=Object(s.useState)(""),[j,b]=Object(s.useState)("");return Object(i.jsxs)("div",{style:{maxWidth:350,margin:"40px auto",padding:24,border:"1px solid #ccc",borderRadius:8,background:"#fff",boxShadow:"0 2px 8px #eee"},children:[Object(i.jsx)("h1",{style:{textAlign:"center",marginBottom:18,color:"#b71c1c",letterSpacing:2},children:"Admin Login"}),Object(i.jsx)("h2",{style:{textAlign:"center",marginBottom:20},children:"\u7ba1\u7406\u54e1\u767b\u5165"}),Object(i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),b("");try{const e=await fetch("/api/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:l})}),s=await e.json();e.ok?(t(s.token),n(a),b("\u767b\u5165\u6210\u529f\uff0c\u6b63\u5728\u8df3\u8f49..."),c.push("/admin/dashboard")):401===e.status?b("\u50c5\u9650\u7ba1\u7406\u54e1\u767b\u5165"):b(s.error||"\u767b\u5165\u5931\u6557")}catch(s){b("\u9023\u7dda\u932f\u8aa4")}},children:[Object(i.jsx)("div",{children:Object(i.jsx)("input",{type:"text",placeholder:"\u5e33\u865f",value:a,onChange:e=>o(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8},autoFocus:!0})}),Object(i.jsx)("div",{children:Object(i.jsx)("input",{type:"password",placeholder:"\u5bc6\u78bc",value:l,onChange:e=>d(e.target.value),required:!0,style:{width:"100%",marginBottom:10,fontSize:16,padding:8}})}),Object(i.jsx)("button",{type:"submit",style:{width:"100%",fontSize:16,padding:10,background:"#b71c1c",color:"#fff",border:"none",borderRadius:4,marginTop:6},children:"\u767b\u5165"})]}),Object(i.jsx)("div",{style:{marginTop:24,textAlign:"center"},children:Object(i.jsx)(q,{})}),j&&Object(i.jsx)("div",{style:{color:"red",marginTop:12,textAlign:"center"},children:j})]})}function L(e){let{adminUser:t}=e;const n=Object(r.f)();return Object(s.useEffect)((()=>{t||n.push("/admin/login")}),[t,n]),Object(i.jsxs)("div",{className:"admin-dashboard",children:[Object(i.jsx)("h1",{children:"\u7ba1\u7406\u54e1\u5f8c\u53f0"}),Object(i.jsx)("ul",{children:Object(i.jsx)("li",{children:Object(i.jsx)(o.b,{to:"/admin/qa",children:"\u554f\u7b54\u7ba1\u7406"})})})]})}function F(e){let{adminToken:t}=e;const[n,c]=Object(s.useState)([]),[a,r]=Object(s.useState)(""),[o,l]=Object(s.useState)("");Object(s.useEffect)((()=>{fetch("/api/questions",{headers:{Authorization:`Bearer ${t}`}}).then((e=>e.json())).then((e=>{e.success?c(e.questions||e.data||[]):r(e.error||"\u8b80\u53d6\u5931\u6557")})).catch((()=>r("\u9023\u7dda\u932f\u8aa4")))}),[t]);return Object(i.jsxs)("div",{className:"knowledge-base",style:{minHeight:"calc(100vh - 140px)"},children:[Object(i.jsx)("h1",{children:"\u554f\u7b54\u7ba1\u7406"}),a&&Object(i.jsx)("div",{style:{color:"red"},children:a}),Object(i.jsxs)("div",{className:"knowledge-controls",children:[Object(i.jsx)("input",{type:"text",placeholder:"\u641c\u5c0b\u554f\u984c...",value:o,onChange:e=>l(e.target.value),className:"search-box"}),Object(i.jsx)("button",{onClick:async()=>{try{const e=new URLSearchParams;o&&e.append("keyword",o);const n=await fetch(`/search?${e.toString()}`,{headers:{Authorization:`Bearer ${t}`}}),s=await n.json();s.success?c(s.data||[]):r(s.error||"\u641c\u5c0b\u5931\u6557")}catch{r("\u641c\u5c0b\u5931\u6557")}},style:{marginLeft:"8px"},children:"\u641c\u5c0b"})]}),Object(i.jsxs)("table",{className:"knowledge-table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"\u554f\u984c"}),Object(i.jsx)("th",{children:"\u5206\u985e"}),Object(i.jsx)("th",{children:"\u8b9a"}),Object(i.jsx)("th",{children:"\u65e5\u671f"}),Object(i.jsx)("th",{children:"\u64cd\u4f5c"})]})}),Object(i.jsx)("tbody",{children:n.map((e=>Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:e.question}),Object(i.jsx)("td",{children:e.category||"\u672a\u5206\u985e"}),Object(i.jsxs)("td",{children:["\ud83d\udc4d ",e.likes||0]}),Object(i.jsx)("td",{children:e.created_at?new Date(e.created_at).toLocaleDateString():""}),Object(i.jsx)("td",{children:Object(i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u78ba\u5b9a\u8981\u522a\u9664\u9019\u500b\u554f\u984c\u55ce\uff1f"))try{const s=await fetch(`/api/questions/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),a=await s.json();a.success?c(n.filter((t=>t._id!==e))):r(a.error||"\u522a\u9664\u5931\u6557")}catch{r("\u9023\u7dda\u932f\u8aa4")}})(e._id),className:"delete-button",style:{backgroundColor:"#dc3545",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"\u2716\ufe0f \u522a\u9664"})})]},e._id)))})]})]})}n(510);const z=[{path:"/admin/dashboard",label:"\u7e3d\u89bd"},{path:"/admin/qa",label:"\u554f\u7b54\u7ba1\u7406"},{path:"/admin/user-management",label:"\u7528\u6236\u7ba1\u7406"},{path:"/admin/feedback-management",label:"\u53cd\u994b\u7ba1\u7406"}];function B(e){let{onLinkClick:t}=e;const n=Object(r.g)();return Object(i.jsx)("nav",{className:"admin-sidebar",children:Object(i.jsx)("ul",{children:z.map((e=>Object(i.jsx)("li",{className:n.pathname===e.path?"active":"",children:Object(i.jsx)(o.b,{to:e.path,onClick:t,children:e.label})},e.path)))})})}n(511);const K=Object({NODE_ENV:"production",PUBLIC_URL:"/GPT-Knowledge-System",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000";function U(){const e=Object(r.f)(),[t,n]=Object(s.useState)([]),[c,a]=Object(s.useState)(""),[o,l]=Object(s.useState)(!0),[d,j]=Object(s.useState)(null),[b,h]=Object(s.useState)(!1),[u,O]=Object(s.useState)({name:"",password:"",role:"user"}),[p,x]=Object(s.useState)(null),[m,g]=Object(s.useState)({name:"",password:"",role:"user"}),f=localStorage.getItem("token");Object(s.useEffect)((()=>{(async()=>{l(!0);try{const e=localStorage.getItem("token");if(!e)return console.error("No token found"),void j("Authentication required");console.log("Fetching users with token:",e);const t=await fetch(`${K}/api/users`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});console.log("Response status:",t.status);const s=await t.json();if(console.log("Response data:",s),403===t.status)return void j("You do not have permission to access this page");s.success?n((s.users||[]).map((e=>({id:e._id,name:e.username,role:e.role||(e.isAdmin?"admin":"user")})))):(console.error("Error in response:",s.error),j(s.error||"Failed to fetch users"))}catch(e){console.error("Fetch error:",e),j("Failed to fetch users: "+e.message)}finally{l(!1)}})()}),[e,f]);const y=t.filter((e=>e.name.toLowerCase().includes(c.toLowerCase()))),v=e=>{const{name:t,value:n}=e.target;g((e=>({...e,[t]:n})))},w=e=>{const{name:t,value:n}=e.target;O((e=>({...e,[t]:n})))};return o?Object(i.jsx)("div",{children:"Loading..."}):d?Object(i.jsxs)("div",{children:["Error: ",d]}):Object(i.jsxs)("div",{className:"admin-user-management",children:[Object(i.jsx)("h1",{children:"\u7528\u6236\u7ba1\u7406"}),Object(i.jsxs)("div",{className:"search-bar",children:[Object(i.jsx)("input",{type:"text",placeholder:"\u641c\u5c0b\u7528\u6236...",value:c,onChange:e=>{a(e.target.value)}}),Object(i.jsx)("button",{className:"add-user-btn",onClick:()=>h(!0),children:"\u65b0\u589e\u7528\u6236"})]}),b&&Object(i.jsxs)("div",{className:"add-user-form",children:[Object(i.jsx)("h2",{children:"\u65b0\u589e\u7528\u6236"}),Object(i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{l(!0);const e=await fetch(`${K}/api/register`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({username:u.name,password:u.password})}),s=await e.json();e.ok&&s.userId?("admin"===u.role&&await fetch(`${K}/api/users/${s.userId}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({role:"admin"})}),n([...t,{id:s.userId,name:u.name,role:u.role}]),O({name:"",password:"",role:"user"}),h(!1)):j(s.error||"Failed to add user")}catch(s){j("Failed to add user")}finally{l(!1)}},children:[Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"\u7528\u6236\u540d\uff1a"}),Object(i.jsx)("input",{type:"text",name:"name",value:u.name,onChange:w,required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"\u5bc6\u78bc\uff1a"}),Object(i.jsx)("input",{type:"password",name:"password",value:u.password,onChange:w,required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"\u89d2\u8272\uff1a"}),Object(i.jsxs)("select",{name:"role",value:u.role,onChange:w,children:[Object(i.jsx)("option",{value:"user",children:"\u4e00\u822c\u7528\u6236"}),Object(i.jsx)("option",{value:"admin",children:"\u7ba1\u7406\u54e1"})]})]}),Object(i.jsxs)("div",{className:"form-actions",children:[Object(i.jsx)("button",{type:"submit",className:"submit-btn",children:"\u65b0\u589e"}),Object(i.jsx)("button",{type:"button",className:"cancel-btn",onClick:()=>h(!1),children:"\u53d6\u6d88"})]})]})]}),p&&Object(i.jsxs)("div",{className:"edit-user-form add-user-form",children:[Object(i.jsx)("h2",{children:"\u7de8\u8f2f\u7528\u6236"}),Object(i.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{l(!0);const e={role:m.role};m.name!==p.name&&(e.name=m.name),m.password&&(e.password=m.password);const s=await fetch(`${K}/api/users/${p.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify(e)}),c=await s.json();c.success?(n(t.map((e=>e.id===p.id?{...e,name:m.name,role:m.role}:e))),x(null),g({name:"",password:"",role:"user"})):j(c.error||"Failed to update user")}catch(s){j("Failed to update user")}finally{l(!1)}},children:[Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"\u7528\u6236\u540d\uff1a"}),Object(i.jsx)("input",{type:"text",name:"name",value:m.name,onChange:v,required:!0})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"\u65b0\u5bc6\u78bc\uff1a"}),Object(i.jsx)("input",{type:"password",name:"password",value:m.password,onChange:v,placeholder:"\u7559\u7a7a\u8868\u793a\u4e0d\u4fee\u6539\u5bc6\u78bc"})]}),Object(i.jsxs)("div",{className:"form-group",children:[Object(i.jsx)("label",{children:"\u89d2\u8272\uff1a"}),Object(i.jsxs)("select",{name:"role",value:m.role,onChange:v,children:[Object(i.jsx)("option",{value:"user",children:"\u4e00\u822c\u7528\u6236"}),Object(i.jsx)("option",{value:"admin",children:"\u7ba1\u7406\u54e1"})]})]}),Object(i.jsxs)("div",{className:"form-actions",children:[Object(i.jsx)("button",{type:"submit",className:"submit-btn",children:"\u4fdd\u5b58"}),Object(i.jsx)("button",{type:"button",className:"cancel-btn",onClick:()=>{x(null),g({name:"",password:"",role:"user"})},children:"\u53d6\u6d88"})]})]})]}),Object(i.jsx)("div",{className:"user-list",children:Object(i.jsxs)("table",{children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"\u7528\u6236\u540d"}),Object(i.jsx)("th",{children:"\u89d2\u8272"}),Object(i.jsx)("th",{children:"\u64cd\u4f5c"})]})}),Object(i.jsx)("tbody",{children:y.map((e=>Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:e.name}),Object(i.jsx)("td",{children:"admin"===e.role?"\u7ba1\u7406\u54e1":"\u4e00\u822c\u7528\u6236"}),Object(i.jsxs)("td",{children:[Object(i.jsx)("button",{onClick:()=>(async(e,s)=>{try{l(!0);const c="admin"===s?"user":"admin",a=await fetch(`${K}/api/users/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({role:c})}),r=await a.json();r.success?n(t.map((t=>t.id===e?{...t,role:c}:t))):j(r.error||"Failed to update user role")}catch(c){j("Failed to update user role")}finally{l(!1)}})(e.id,e.role),className:"admin"===e.role?"remove-admin":"make-admin",children:"admin"===e.role?"\u53d6\u6d88\u7ba1\u7406\u54e1":"\u8a2d\u70ba\u7ba1\u7406\u54e1"}),Object(i.jsx)("button",{onClick:()=>(e=>{x(e),g({name:e.name,password:"",role:e.role})})(e),className:"edit-user",children:"\u7de8\u8f2f"}),Object(i.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{l(!0);const s=await fetch(`${K}/api/users/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${f}`}}),c=await s.json();c.success?n(t.filter((t=>t.id!==e))):j(c.error||"Failed to delete user")}catch(s){j("Failed to delete user")}finally{l(!1)}})(e.id),className:"delete-user",children:"\u522a\u9664"})]})]},e.id)))})]})})]})}const J=Object({NODE_ENV:"production",PUBLIC_URL:"/GPT-Knowledge-System",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000";function W(){Object(r.f)();const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)(!0),[a,o]=Object(s.useState)(null),l=localStorage.getItem("token");Object(s.useEffect)((()=>{(async()=>{c(!0);try{const e=await fetch(`${J}/api/feedback`,{headers:{Authorization:`Bearer ${l}`}}),n=await e.json();n.success?t(n.feedbacks||[]):o(n.error||"Failed to fetch feedback")}catch(e){o("Failed to fetch feedback: "+e.message)}finally{c(!1)}})()}),[l]);return n?Object(i.jsx)("div",{children:"\u8f09\u5165\u4e2d..."}):a?Object(i.jsxs)("div",{style:{color:"red"},children:["Error: ",a]}):Object(i.jsxs)("div",{style:{padding:"24px"},children:[Object(i.jsx)("h2",{children:"\u53cd\u994b\u7ba1\u7406"}),Object(i.jsxs)("table",{border:"1",cellPadding:"8",style:{width:"100%",marginTop:"16px"},children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"\u7528\u6236\u540d"}),Object(i.jsx)("th",{children:"\u5167\u5bb9"}),Object(i.jsx)("th",{children:"\u63d0\u4ea4\u6642\u9593"}),Object(i.jsx)("th",{children:"\u64cd\u4f5c"})]})}),Object(i.jsx)("tbody",{children:0===e.length?Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:"4",children:"\u66ab\u7121\u53cd\u994b"})}):e.map((n=>Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:n.username}),Object(i.jsx)("td",{children:n.content}),Object(i.jsx)("td",{children:new Date(n.created_at).toLocaleString()}),Object(i.jsx)("td",{children:Object(i.jsx)("button",{onClick:()=>(async n=>{if(window.confirm("\u78ba\u5b9a\u8981\u522a\u9664\u6b64\u53cd\u994b\u55ce\uff1f")){c(!0);try{const s=await fetch(`${J}/api/feedback/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}}),c=await s.json();c.success?t(e.filter((e=>e._id!==n))):o(c.error||"Failed to delete feedback")}catch(s){o("Failed to delete feedback: "+s.message)}finally{c(!1)}}})(n._id),style:{color:"red"},children:"\u522a\u9664"})})]},n._id)))})]})]})}var H=n(149);const G={position:"absolute",top:10,right:10,zIndex:1e3,background:"#f44336",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 16px",cursor:"pointer"};var M=function(){const[e,t]=Object(s.useState)((()=>localStorage.getItem("token")||"")),[n,c]=Object(s.useState)(!1),[a]=Object(s.useState)(""),o=()=>c((e=>!e)),d=e=>{t(e),localStorage.setItem("token",e);try{const t=Object(H.a)(e);!t||!0!==t.isAdmin&&"admin"!==t.role?window.location.replace("/GPT-Knowledge-System/#/"):window.location.replace("/GPT-Knowledge-System/#/admin/dashboard")}catch(n){window.location.replace("/GPT-Knowledge-System/#/")}},j=()=>{t(""),localStorage.removeItem("token")},b=Object(r.g)();if(!e)return"/admin/login"!==b.pathname&&"/login"!==b.pathname?(window.location.hash="#/login",null):"/admin/login"===b.pathname?Object(i.jsx)($,{setAdminToken:d,setAdminUser:()=>{}}):Object(i.jsx)(R,{setToken:d});let O=!1;try{const t=Object(H.a)(e);O=t&&(!0===t.isAdmin||"admin"===t.role)}catch(p){O=!1}return O&&!b.pathname.startsWith("/admin")?(window.location.replace("#/admin/dashboard"),null):!O&&b.pathname.startsWith("/admin")?(window.location.replace("#/"),null):O?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("button",{className:"hamburger",onClick:o,children:"\u2630"}),Object(i.jsx)("button",{onClick:j,style:G,children:"\u767b\u51fa"}),Object(i.jsxs)("div",{className:"app-container",children:[Object(i.jsx)(B,{}),Object(i.jsx)("div",{className:"content",style:{marginLeft:200},children:Object(i.jsxs)(r.c,{children:[Object(i.jsx)(r.a,{exact:!0,path:"/admin/dashboard",component:L}),Object(i.jsx)(r.a,{path:"/admin/qa",render:()=>Object(i.jsx)(F,{adminToken:e})}),Object(i.jsx)(r.a,{path:"/admin/user-management",component:U}),Object(i.jsx)(r.a,{path:"/admin/feedback-management",component:W})]})})]})]}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("button",{className:"hamburger",onClick:o,children:"\u2630"}),Object(i.jsx)("button",{onClick:j,style:G,children:"\u767b\u51fa"}),Object(i.jsxs)("div",{className:"app-container",children:[Object(i.jsx)(l,{isOpen:n,onLinkClick:()=>c(!1)}),Object(i.jsx)("div",{className:"content",children:Object(i.jsxs)(r.c,{children:[Object(i.jsx)(r.a,{exact:!0,path:"/",component:_}),Object(i.jsx)(r.a,{path:"/knowledge",component:h}),Object(i.jsx)(r.a,{path:"/documents",render:()=>Object(i.jsx)(u,{user:a})}),Object(i.jsx)(r.a,{path:"/collaboration",component:m}),Object(i.jsx)(r.a,{path:"/analytics",component:I}),Object(i.jsx)(r.a,{path:"/feedback",component:D})]})})]})]})};a.a.render(Object(i.jsx)(o.a,{children:Object(i.jsx)(M,{})}),document.getElementById("root"))}},[[512,1,2]]]);
//# sourceMappingURL=main.01151d00.chunk.js.map